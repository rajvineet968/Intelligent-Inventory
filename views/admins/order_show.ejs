<%- layout("layouts/boilerplate") %>

    <div class="container mt-4 animate-fade">
        <h3 class="animate-title" style="color: #ffffff; font-weight: 700; margin-bottom: 20px;">
            Order #<%= order.OrderID %>
        </h3>

        <p style="color: #e0e0e0; font-size: 16px; margin-bottom: 24px;">
            <b>Status:</b>
            <span style="color: #0d6efd; font-weight: 600;">
                <%= order.Status %>
            </span>
        </p>

        <table class="table animate-card" style="background: rgba(31, 37, 42, 0.7); border-radius: 15px; overflow: hidden; border: 1px solid rgb(0, 0, 0);">
            <thead style="background: rgba(25, 26, 27, 0.2);">
                <tr>
                    <th style="color: #0e0d0d; font-weight: 700;">Product</th>
                    <th style="color: #0e0d0d; font-weight: 700;">Qty</th>
                    <th style="color: #0e0d0d; font-weight: 700;">Unit</th>
                    <th style="color: #0e0d0d; font-weight: 700;">Total</th>
                </tr>
            </thead>
            <tbody>
                <% items.forEach(i=> { %>
                    <tr style="border-bottom: 1px solid rgba(255, 255, 255, 0.05); transition: background 0.3s ease;">
                        <td style="color: #0e0d0d; padding: 14px;">
                            <%= i.StockCode %>
                        </td>
                        <td style="color: #0e0d0d; padding: 14px;">
                            <%= i.Quantity %>
                        </td>
                        <td style="color: #0d6efd; padding: 14px; font-weight: 500;">
                            ₹ <%= Number(i.Unit_Price).toFixed(2) %>
                        </td>
                        <td style="color: #28a745; padding: 14px; font-weight: 600;">
                            ₹ <%= Number(i.total).toFixed(2) %>
                        </td>
                    </tr>
                    <% }) %>
            </tbody>
        </table>

        <h5 style="color: #ffffff; font-weight: 700; margin-top: 28px; margin-bottom: 12px;">
            Delivery Address
        </h5>
        <p style="color: #d0d0d0; background: rgba(31, 37, 42, 0.6); padding: 16px; border-radius: 10px; border-left: 4px solid #0d6efd; line-height: 1.8;">
            <%= order.address_line1 %><br>
                <% if(order.address_line2){ %>
                    <%= order.address_line2 %><br>
                        <% } %>
                            <strong style="color: #ffffff;"><%= order.city %>, <%= order.state %> - <%= order.pincode %></strong>
        </p>

        <h4 style="color: #28a745; font-weight: 700; margin-top: 24px; font-size: 22px;">
            Total: ₹ <%= Number(order.total_amount).toFixed(2) %>
        </h4>

        <!-- STATUS UPDATE -->
        <form method="POST" action="/admin/orders/<%= order.OrderID %>/status?_method=PUT" class="mt-4 animate-card" style="background: rgba(31, 37, 42, 0.7); padding: 20px; border-radius: 12px; border: 1px solid rgba(13, 110, 253, 0.3);">
            <label style="color: #ffffff; font-weight: 600; margin-bottom: 10px; display: block;">
                Update Order Status
            </label>
            <select name="status" class="form-select w-25" style="background: rgba(13, 110, 253, 0.2); color: #ffffff; border: 2px solid #0d6efd; border-radius: 8px; padding: 10px 12px; font-weight: 500; transition: all 0.3s ease; cursor: pointer; appearance: none; background-image: url('data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2212%22 height=%228%22 viewBox=%220 0 12 8%22><path fill=%22%23ffffff%22 d=%22M1 1l5 5 5-5%22/></svg>'); background-repeat: no-repeat; background-position: right 10px center; padding-right: 30px;">
                <% ['PLACED','CONFIRMED','SHIPPED','DELIVERED','CANCELLED'].forEach(s=> { %>
                    <option value="<%= s %>" <%=order.Status===s ? 'selected' : '' %> style="background: #1f252a; color: #ffffff;">
                        <%= s %>
                    </option>
                    <% }) %>
            </select>

            <button class="btn btn-success mt-3" style="font-weight: 700; padding: 10px 24px; border-radius: 8px; background: #28a745; border: none; transition: all 0.3s ease; font-size: 16px;" 
                    onmouseover="this.style.background='#218838'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 20px rgba(40, 167, 69, 0.3)';"
                    onmouseout="this.style.background='#28a745'; this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                Update Status
            </button>
        </form>
    </div>